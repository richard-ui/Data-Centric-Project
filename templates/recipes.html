{% extends "base.html" %}
{% block content %}

    <h1 class="center-align yellow lighten-2">Recipe Page</h1>

    <div class="row card-panel grey lighten-5">
        <form action="{{ url_for('search_recipe') }}" method="post" class="col s12">
            <div class="row center-align">
                <div class="input-field search_input col s12 m7">
                    <i class="fas fa-search prefix"></i>
                     <input list="recipe_names" placeholder="Search Recipe..." id="query" name="query" />
                      
                     <datalist id="recipe_names">
                        {% for recipe in recipes %}
                        <option value="{{ recipe.recipe_name }}"></option>
                        {% endfor %}
                      </datalist>         
                </div>

                <div class="col s12 m5">
                    <a href="{{ url_for('get_recipes') }}" class="red btn text-shadow">
                        <i class="fas fa-sync prefix"></i> Reset
                    </a>

                    <button type="submit" class="light-blue darken-1 btn text-shadow">
                        <i class="fas fa-search left"></i> Search
                    </button>
                </div>
            </div>
        </form>
    </div>

    <div class="row card-panel grey lighten-5">
        <form action="{{ url_for('search_by_cuisine') }}" method="post" class="col s12">
            <div class="row">    
                <div class="row">
                    <div class="input-field col s12 m7">
                        <i class="fas fa-concierge-bell prefix"></i>
                        <select id="cuisine_name" name="cuisine_name" class="validate">
                            <option value=""> -- </option>
                            {% for cuisine in cuisines %}
                                <option value="{{ cuisine.cuisine_name }}">{{ cuisine.cuisine_name }}</option>
                            {% endfor %}
                        </select>
                        <label for="cuisine_name">Search By Cuisine:</label>
                    </div>

                    <div class="col s12 m5">
                        <a href="{{ url_for('get_recipes') }}" class="red btn text-shadow">
                            <i class="fas fa-sync prefix"></i> Reset
                        </a>

                        <button type="submit" class="light-blue darken-1 btn text-shadow">
                            <i class="fas fa-search left"></i> Search
                        </button>
                    </div>

                </div>
            </div>
        </form>
    </div>
     
    {% if recipes|length > 0 %}
         {% for recipe in recipes %}
         
         <div class="card-panel col s12 yellow lighten-2">
             <form class="form-fieldset">
             <fieldset>
             <legend>{{ recipe.recipe_name }}</legend>
                <div class="row">
                    <div class="col s12 m6">
                       Cuisine type: '<em>{{ recipe.cuisine_name }}</em>'<br>   
                    </div>
                     <div class="col s12 m6">
                        <h5>Recipe made By:</h5> '<b>{{ recipe.created_by }}</b>'<br>   
                    </div>
                     <div class="col s12 m4">
                        <img id="imgdata" src="{{ url_for('static', filename='img/') }}{{ recipe.file }}" alt="{{ recipe.recipe_name }}"
                        class="responsive-img"> 
                    </div>
                </div>

                <div class="row">
                    <div class="col s12  m6">
                        <div class="times_title">Prep Time:</div>
                        <div class="times">{{ recipe.prep_time }}</div>
                    </div>
                    <div class="col s12 m6">
                        <div class="times_title">Cook Time:</div>
                        <div class="times">{{ recipe.cook_time }}</div>
                    </div>
                </div>

                <div class="row">
                    <div class="col s12 m6">
                        <h5>Ingredients</h5>
                        <ul class="browser-default">
                            {% for ingredient in recipe.ingredients %}
                            <li class="list-style" style="list-style-type: square;">{{ ingredient }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="col s12 m6">
                        <h5>Prep steps</h5>
                        <ol class="browser-default">
                            {% for prep_step in recipe.prep_steps %}
                            <li class="list-style">{{ prep_step }}</li>
                            {% endfor %}
                        </ol>
                    </div>
                </div>
                
                 <div class="s12">
                    {% if session.user|lower == recipe.user_id|lower %}
                        <a href="{{ url_for('edit_recipe', recipe_id=recipe._id) }}"
                            class="waves-effect waves-light btn-small button-style">Edit</a>
                        <a class="waves-effect waves-light btn-small red modal-trigger button-style" href="#modaldel">Delete</a>
                        
                        <!-- Modal Structure -->

                        <div id="modaldel" class="modal">
                            <div class="modal-content">
                                <h4>Are you sure you want to delete this recipe?</h4>
                            </div>
                            <div class="modal-footer">
                                <a href="{{ url_for('delete_recipe', recipe_id=recipe._id) }}"
                                    class="modal-close waves-effect waves-light btn red button-style">Delete</a>
                                <a href="{{ url_for('get_recipes') }}"
                                    class="modal-close waves-effect waves-light btn-small button-style">Cancel</a>
                            </div>
                        </div>
                    {% endif %}
                </div>
                </fieldset>
                </form>
            </div>
            
            {% endfor %}
            
        {% else %}
            <h3 class="red-text text-darken-4 center-align">No recipes found!</h3>
            
        {% endif %}
{% endblock %}